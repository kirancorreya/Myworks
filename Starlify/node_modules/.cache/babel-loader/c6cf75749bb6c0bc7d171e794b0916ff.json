{"ast":null,"code":"var _jsxFileName = \"/Users/kirancorreya/Site/Starlify/src/pages/dashboard/browsers/ModalAcess.js\";\nimport React, { Component } from \"react\";\nimport { Table, Modal, ModalBody, Input, FormGroup } from \"reactstrap\";\nimport pen from \"../../../_assets/icons/icons/edit-icon.svg\";\nimport list from \"../../../_assets/icons/icons/List-icon.svg\";\nimport { connect } from \"react-redux\";\n\nclass ModalAcess extends Component {\n  constructor(props) {\n    super(props);\n\n    this.modalToggle = () => {\n      this.setState({\n        popup: !this.state.popup,\n        eventType: null\n      });\n    };\n\n    this.selectModel = e => {\n      this.setState({\n        modeluri: e.target.value\n      });\n      fetch(process.env.REACT_APP_API + e.target.value).then(res => res.json()).then(result => {\n        this.setState({\n          model: result,\n          popup: false,\n          accessEditor: true\n        });\n      }).catch(error => {\n        this.setState({\n          popup: false\n        });\n      });\n      var modelArr = e.target.value.split(\"/\");\n      this.fetchModelGrants(modelArr[2]);\n      this.fetchDivisions(this.props.domain);\n    };\n\n    this.fetchModelGrants = modelId => {\n      fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + this.props.domain + \"/grant/\" + modelId).then(res => res.json()).then(json => {\n        this.setState({\n          grants: json\n        });\n      });\n    };\n\n    this.fetchDivisions = domainId => {\n      return fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId).then(res => res.json()).then(result => {\n        var org = result.organisation;\n        fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId + \"/organisation/\" + org.id + \"/organisations\").then(res => res.json()).then(json => {\n          var organisations = json;\n\n          for (var i = 0; i < organisations.length; i++) {\n            let org = organisations[i];\n            org[\"teams\"] = [];\n\n            if (org._links && org._links.length !== 0) {\n              this.fetchTeams(domainId, this.state.model.id, org.id).then(teams => org[\"teams\"] = teams);\n            }\n          }\n\n          this.setState({\n            divisions: organisations\n          });\n          return true;\n        });\n      });\n    };\n\n    this.fetchTeams = (domainId, modelId, orgid) => {\n      return fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId + \"/organisation/\" + orgid + \"/organisations\").then(res => res.json()).then(json => {\n        var organisations = json;\n\n        for (var i = 0; i < organisations.length; i++) {\n          let org = organisations[i];\n          org[\"persons\"] = [];\n\n          if (org._links && org._links.length !== 0) {\n            this.fetchPersons(domainId, modelId, org.id).then(persons => org[\"persons\"] = persons);\n          }\n        }\n\n        return organisations;\n      });\n    };\n\n    this.fetchPersons = (domainId, modelId, orgid) => {\n      return fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId + \"/organisation/\" + orgid + \"/persons\").then(res => res.json()).then(persons => {\n        return persons;\n      });\n    };\n\n    this.onGrantChange = (e, grantid) => {\n      console.log(\"evnt\", e.target.value);\n\n      if (e.target.checked) {\n        this.addGrantAccess(this.props.domain, this.state.model.id, grantid, e.target.value);\n      } else {\n        this.deleteGrantAccess(this.props.domain, this.state.model.id, grantid, e.target.value);\n      }\n    };\n\n    this.addGrantAccess = (domainId, modelId, grantid, value) => {\n      fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId + \"/grant/\" + modelId + \"/\" + grantid + \"/permission/\" + value, {\n        method: \"POST\"\n      }).then(result => {\n        console.log(\"added\");\n        this.fetchModelGrants(this.state.model.id);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.deleteGrantAccess = (domainId, modelId, grantid, value) => {\n      fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId + \"/grant/\" + modelId + \"/\" + grantid + \"/permission/\" + value, {\n        method: \"DELETE\"\n      }).then(result => {\n        console.log(\"deleted\");\n        this.fetchModelGrants(this.state.model.id);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.close = this.close.bind(this);\n    this.fetchDivisions = this.fetchDivisions.bind(this);\n    this.fetchTeams = this.fetchTeams.bind(this);\n    this.fetchPersons = this.fetchPersons.bind(this);\n    this.fetchModelGrants = this.fetchModelGrants.bind(this);\n    this.state = {\n      modeluri: \"\",\n      model: null,\n      models: [],\n      divisions: [],\n      grants: [],\n      accessEditor: false,\n      popup: false,\n      eventType: null\n    };\n  }\n\n  close(type) {\n    this.props.close(type);\n  }\n\n  componentDidMount() {\n    var domainID = this.props.domain;\n\n    if (domainID !== \"\") {\n      fetch(process.env.REACT_APP_API + \"/domain/\" + domainID).then(res => res.json()).then(result => {\n        this.setState({\n          models: result.links\n        });\n      }).catch(error => {\n        this.setState({\n          models: []\n        });\n      });\n    }\n  }\n\n  componentWillReceiveProps(newProps) {\n    const domain = newProps.domain,\n          type = newProps.type;\n\n    switch (type) {\n      case \"SELECTDOMAIN\":\n        this.setState({\n          modeluri: \"\",\n          model: null,\n          models: [],\n          divisions: [],\n          grants: [],\n          accessEditor: false,\n          popup: false,\n          eventType: null\n        });\n\n        if (domain !== \"\") {\n          fetch(process.env.REACT_APP_API + \"/domain/\" + domain).then(res => res.json()).then(result => {\n            this.setState({\n              models: result.links\n            });\n          }).catch(error => {\n            this.setState({\n              models: []\n            });\n          });\n        }\n\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const models = this.state.models;\n    return React.createElement(\"div\", {\n      className: \"browser\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      isOpen: this.state.popup,\n      toggle: this.modalToggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, React.createElement(ModalBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, this.state.eventType === \"model-choose\" && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"text-center m-b-30\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, \"Choose model\"), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }, React.createElement(Input, {\n      type: \"select\",\n      onChange: this.selectModel.bind(this),\n      value: this.state.modeluri,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }, \"Select Model\"), models.map(item => React.createElement(\"option\", {\n      key: item.uri,\n      value: item.uri,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }, item.title))))))), this.state.accessEditor === false && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"browser_header text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-key submenu-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }), React.createElement(\"h3\", {\n      className: \"d-inline-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, \"Models Access\"), React.createElement(\"i\", {\n      className: \"fas fa-times system-down-icon\",\n      onClick: () => this.close(\"modelAccess\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"text-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \"modelChoose\",\n      onClick: () => {\n        this.setState({\n          eventType: \"model-choose\",\n          popup: true\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, \"Choose model\"))), React.createElement(\"div\", {\n      className: \"browser_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-center text-white m-t-65\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, \"So you need to give access to your division, teams or developers?\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }), \"You\\u2019ve come to the right place.\"), React.createElement(\"p\", {\n      className: \"text-center text-white m-t-65\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, \"Just click the Choose model button and choose what \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }), \"model you need to work in and then you can start adding \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }), \"your division, teams and developers.\"), React.createElement(\"h1\", {\n      className: \"text-center text-white m-t-65\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"No chosen model\"))), this.state.accessEditor === true && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"browser_header text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-key submenu-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }), React.createElement(\"h3\", {\n      className: \"d-inline-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, \"Models Access\"), React.createElement(\"i\", {\n      className: \"fas fa-times system-down-icon\",\n      onClick: () => this.close(\"modelAccess\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, \"Edit models access for \", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, this.state.model.name)), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn grey-btn\",\n      onClick: () => {\n        this.setState({\n          eventType: \"model-choose\",\n          popup: true\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331\n      },\n      __self: this\n    }, \"Change model \", React.createElement(\"img\", {\n      src: pen,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"browser_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"division_model\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"browser_body_header text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"d-inline-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }, \"Divisions\")), React.createElement(\"div\", {\n      className: \"browser_body_content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    }, React.createElement(Table, {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 348\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      width: \"50%\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350\n      },\n      __self: this\n    }), React.createElement(\"th\", {\n      width: \"25%\",\n      className: \"text-white text-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351\n      },\n      __self: this\n    }, \"Read\"), React.createElement(\"th\", {\n      width: \"25%\",\n      className: \"text-white text-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    }, \"Write\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, this.state.divisions && this.state.divisions.length !== 0 && this.state.divisions.map((division, index) => {\n      const perms = [\"RESOURCE_ANY\", \"RESOURCE_READ\"];\n      var divRead = false;\n      var divWrite = false;\n      this.state.grants.forEach((item, i) => {\n        if (item.principal.id === division.id) {\n          divRead = perms.some(r => item.permissions.includes(r)) ? \"checked\" : \"\";\n          divWrite = item.permissions.includes(\"RESOURCE_ANY\") ? \"checked\" : \"\";\n        }\n      });\n      return React.createElement(\"div\", {\n        className: \"tablewrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 381\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        key: division.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 382\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        width: \"50%\",\n        className: \"text-grey text-left division-table-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }, \" \", division.name, \" \"), React.createElement(\"td\", {\n        width: \"25%\",\n        className: \"division-table-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"read_\" + division.id,\n        checked: divRead,\n        defaultValue: \"RESOURCE_READ\",\n        onChange: e => {\n          this.onGrantChange(e, division.id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"read_\" + division.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404\n        },\n        __self: this\n      }))), React.createElement(\"td\", {\n        width: \"25%\",\n        className: \"division-table-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 409\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 413\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        defaultValue: \"RESOURCE_ANY\",\n        id: \"write_\" + division.id,\n        checked: divWrite,\n        onChange: e => {\n          this.onGrantChange(e, division.id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"write_\" + division.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423\n        },\n        __self: this\n      })))), React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        width: \"50%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430\n        },\n        __self: this\n      }, \"Team\"), React.createElement(\"td\", {\n        width: \"25%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 434\n        },\n        __self: this\n      }))), React.createElement(\"td\", {\n        width: \"25%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 438\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 439\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440\n        },\n        __self: this\n      })))), React.createElement(\"tr\", {\n        className: \"developer-td\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        width: \"50%\",\n        className: \"text-grey text-left division-table-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 445\n        },\n        __self: this\n      }, \"Developer\"), React.createElement(\"td\", {\n        width: \"25%\",\n        className: \"text-grey text-left division-table-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 451\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 455\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 456\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 457\n        },\n        __self: this\n      }))), React.createElement(\"td\", {\n        width: \"25%\",\n        className: \"text-grey text-left division-table-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 460\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"customCheckbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 464\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"check1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 466\n        },\n        __self: this\n      })))));\n    }))))))));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    domain: state.model.domain,\n    type: state.model.type\n  };\n}\n\nexport default connect(mapStateToProps)(ModalAcess);","map":{"version":3,"sources":["/Users/kirancorreya/Site/Starlify/src/pages/dashboard/browsers/ModalAcess.js"],"names":["React","Component","Table","Modal","ModalBody","Input","FormGroup","connect","ModalAcess","constructor","props","modalToggle","setState","popup","state","eventType","selectModel","e","modeluri","target","value","fetch","process","env","REACT_APP_API","then","res","json","result","model","accessEditor","catch","error","modelArr","split","fetchModelGrants","fetchDivisions","domain","modelId","grants","domainId","org","organisation","id","organisations","i","length","_links","fetchTeams","teams","divisions","orgid","fetchPersons","persons","onGrantChange","grantid","console","log","checked","addGrantAccess","deleteGrantAccess","method","close","bind","models","type","componentDidMount","domainID","links","componentWillReceiveProps","newProps","render","map","item","uri","title","name","pen","division","index","perms","divRead","divWrite","forEach","principal","some","r","permissions","includes","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Table, Modal, ModalBody, Input, FormGroup } from \"reactstrap\";\nimport pen from \"../../../_assets/icons/icons/edit-icon.svg\";\nimport list from \"../../../_assets/icons/icons/List-icon.svg\";\nimport { connect } from \"react-redux\";\n\nclass ModalAcess extends Component {\n  constructor(props) {\n    super(props);\n    this.close = this.close.bind(this);\n    this.fetchDivisions = this.fetchDivisions.bind(this);\n    this.fetchTeams = this.fetchTeams.bind(this);\n    this.fetchPersons = this.fetchPersons.bind(this);\n    this.fetchModelGrants = this.fetchModelGrants.bind(this);\n    this.state = {\n      modeluri: \"\",\n      model: null,\n      models: [],\n      divisions: [],\n      grants: [],\n      accessEditor: false,\n      popup: false,\n      eventType: null\n    };\n  }\n  close(type) {\n    this.props.close(type);\n  }\n\n  modalToggle = () => {\n    this.setState({\n      popup: !this.state.popup,\n      eventType: null\n    });\n  };\n\n  selectModel = e => {\n    this.setState({ modeluri: e.target.value });\n    fetch(process.env.REACT_APP_API + e.target.value)\n      .then(res => res.json())\n      .then(result => {\n        this.setState({\n          model: result,\n          popup: false,\n          accessEditor: true\n        });\n      })\n      .catch(error => {\n        this.setState({ popup: false });\n      });\n    var modelArr = e.target.value.split(\"/\");\n    this.fetchModelGrants(modelArr[2]);\n    this.fetchDivisions(this.props.domain);\n  };\n\n  fetchModelGrants = modelId => {\n    fetch(\n      process.env.REACT_APP_API +\n        \"/hypermedia/domain/\" +\n        this.props.domain +\n        \"/grant/\" +\n        modelId\n    )\n      .then(res => res.json())\n      .then(json => {\n        this.setState({ grants: json });\n      });\n  };\n\n  fetchDivisions = domainId => {\n    return fetch(process.env.REACT_APP_API + \"/hypermedia/domain/\" + domainId)\n      .then(res => res.json())\n      .then(result => {\n        var org = result.organisation;\n        fetch(\n          process.env.REACT_APP_API +\n            \"/hypermedia/domain/\" +\n            domainId +\n            \"/organisation/\" +\n            org.id +\n            \"/organisations\"\n        )\n          .then(res => res.json())\n          .then(json => {\n            var organisations = json;\n            for (var i = 0; i < organisations.length; i++) {\n              let org = organisations[i];\n              org[\"teams\"] = [];\n              if (org._links && org._links.length !== 0) {\n                this.fetchTeams(domainId, this.state.model.id, org.id).then(\n                  teams => (org[\"teams\"] = teams)\n                );\n              }\n            }\n            this.setState({\n              divisions: organisations\n            });\n            return true;\n          });\n      });\n  };\n\n  fetchTeams = (domainId, modelId, orgid) => {\n    return fetch(\n      process.env.REACT_APP_API +\n        \"/hypermedia/domain/\" +\n        domainId +\n        \"/organisation/\" +\n        orgid +\n        \"/organisations\"\n    )\n      .then(res => res.json())\n      .then(json => {\n        var organisations = json;\n        for (var i = 0; i < organisations.length; i++) {\n          let org = organisations[i];\n          org[\"persons\"] = [];\n          if (org._links && org._links.length !== 0) {\n            this.fetchPersons(domainId, modelId, org.id).then(\n              persons => (org[\"persons\"] = persons)\n            );\n          }\n        }\n        return organisations;\n      });\n  };\n\n  fetchPersons = (domainId, modelId, orgid) => {\n    return fetch(\n      process.env.REACT_APP_API +\n        \"/hypermedia/domain/\" +\n        domainId +\n        \"/organisation/\" +\n        orgid +\n        \"/persons\"\n    )\n      .then(res => res.json())\n      .then(persons => {\n        return persons;\n      });\n  };\n\n  onGrantChange = (e, grantid) => {\n    console.log(\"evnt\", e.target.value);\n    if (e.target.checked) {\n      this.addGrantAccess(\n        this.props.domain,\n        this.state.model.id,\n        grantid,\n        e.target.value\n      );\n    } else {\n      this.deleteGrantAccess(\n        this.props.domain,\n        this.state.model.id,\n        grantid,\n        e.target.value\n      );\n    }\n  };\n\n  addGrantAccess = (domainId, modelId, grantid, value) => {\n    fetch(\n      process.env.REACT_APP_API +\n        \"/hypermedia/domain/\" +\n        domainId +\n        \"/grant/\" +\n        modelId +\n        \"/\" +\n        grantid +\n        \"/permission/\" +\n        value,\n      { method: \"POST\" }\n    )\n      .then(result => {\n        console.log(\"added\");\n        this.fetchModelGrants(this.state.model.id);\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  };\n\n  deleteGrantAccess = (domainId, modelId, grantid, value) => {\n    fetch(\n      process.env.REACT_APP_API +\n        \"/hypermedia/domain/\" +\n        domainId +\n        \"/grant/\" +\n        modelId +\n        \"/\" +\n        grantid +\n        \"/permission/\" +\n        value,\n      { method: \"DELETE\" }\n    )\n      .then(result => {\n        console.log(\"deleted\");\n        this.fetchModelGrants(this.state.model.id);\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  };\n\n  componentDidMount() {\n    var domainID = this.props.domain;\n    if (domainID !== \"\") {\n      fetch(process.env.REACT_APP_API + \"/domain/\" + domainID)\n        .then(res => res.json())\n        .then(result => {\n          this.setState({\n            models: result.links\n          });\n        })\n        .catch(error => {\n          this.setState({ models: [] });\n        });\n    }\n  }\n\n  componentWillReceiveProps(newProps) {\n    const { domain, type } = newProps;\n    switch (type) {\n      case \"SELECTDOMAIN\":\n        this.setState({\n          modeluri: \"\",\n          model: null,\n          models: [],\n          divisions: [],\n          grants: [],\n          accessEditor: false,\n          popup: false,\n          eventType: null\n        });\n        if (domain !== \"\") {\n          fetch(process.env.REACT_APP_API + \"/domain/\" + domain)\n            .then(res => res.json())\n            .then(result => {\n              this.setState({\n                models: result.links\n              });\n            })\n            .catch(error => {\n              this.setState({ models: [] });\n            });\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  render() {\n    const models = this.state.models;\n    return (\n      <div className=\"browser\">\n        <Modal isOpen={this.state.popup} toggle={this.modalToggle}>\n          <ModalBody>\n            {this.state.eventType === \"model-choose\" && (\n              <div>\n                <h4 className=\"text-center m-b-30\">Choose model</h4>\n                <FormGroup>\n                  <Input\n                    type=\"select\"\n                    onChange={this.selectModel.bind(this)}\n                    value={this.state.modeluri}\n                  >\n                    <option value=\"\">Select Model</option>\n                    {models.map(item => (\n                      <option key={item.uri} value={item.uri}>\n                        {item.title}\n                      </option>\n                    ))}\n                  </Input>\n                </FormGroup>\n              </div>\n            )}\n          </ModalBody>\n        </Modal>\n        {this.state.accessEditor === false && (\n          <div>\n            <div className=\"browser_header text-white\">\n              <i className=\"fas fa-key submenu-icon\"></i>\n              <h3 className=\"d-inline-block\">Models Access</h3>\n              <i\n                className=\"fas fa-times system-down-icon\"\n                onClick={() => this.close(\"modelAccess\")}\n              />\n              <div className=\"text-right\">\n                <a\n                  className=\"modelChoose\"\n                  onClick={() => {\n                    this.setState({ eventType: \"model-choose\", popup: true });\n                  }}\n                >\n                  Choose model\n                </a>\n              </div>\n            </div>\n            <div className=\"browser_body\">\n              <p className=\"text-center text-white m-t-65\">\n                So you need to give access to your division, teams or\n                developers?\n                <br />\n                You’ve come to the right place.\n              </p>\n              <p className=\"text-center text-white m-t-65\">\n                Just click the Choose model button and choose what <br />\n                model you need to work in and then you can start adding <br />\n                your division, teams and developers.\n              </p>\n              <h1 className=\"text-center text-white m-t-65\">No chosen model</h1>\n            </div>\n          </div>\n        )}\n\n        {this.state.accessEditor === true && (\n          <div>\n            <div className=\"browser_header text-white\">\n              <i className=\"fas fa-key submenu-icon\"></i>\n              <h3 className=\"d-inline-block\">Models Access</h3>\n              <i\n                className=\"fas fa-times system-down-icon\"\n                onClick={() => this.close(\"modelAccess\")}\n              />\n              <p>\n                Edit models access for <span>{this.state.model.name}</span>\n              </p>\n              <div>\n                <button\n                  className=\"btn grey-btn\"\n                  onClick={() => {\n                    this.setState({ eventType: \"model-choose\", popup: true });\n                  }}\n                >\n                  Change model <img src={pen} alt=\"\" />\n                </button>\n              </div>\n            </div>\n            <div className=\"browser_body\">\n              <div className=\"division_model\">\n                <div className=\"browser_body_header text-white\">\n                  <h4 className=\"d-inline-block\">Divisions</h4>\n                </div>\n                <div className=\"browser_body_content\">\n                  <Table className=\"text-white\">\n                    <thead>\n                      <tr>\n                        <th width=\"50%\"></th>\n                        <th width=\"25%\" className=\"text-white text-small\">\n                          Read\n                        </th>\n                        <th width=\"25%\" className=\"text-white text-small\">\n                          Write\n                        </th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {this.state.divisions &&\n                        this.state.divisions.length !== 0 &&\n                        this.state.divisions.map((division, index) => {\n                          const perms = [\"RESOURCE_ANY\", \"RESOURCE_READ\"];\n                          var divRead = false;\n                          var divWrite = false;\n                          this.state.grants.forEach((item, i) => {\n                            if (item.principal.id === division.id) {\n                              divRead = perms.some(r =>\n                                item.permissions.includes(r)\n                              )\n                                ? \"checked\"\n                                : \"\";\n                              divWrite = item.permissions.includes(\n                                \"RESOURCE_ANY\"\n                              )\n                                ? \"checked\"\n                                : \"\";\n                            }\n                          });\n                          return (\n                            <div className=\"tablewrapper\">\n                              <tr key={division.id}>\n                                <td\n                                  width=\"50%\"\n                                  className=\"text-grey text-left division-table-name\"\n                                >\n                                  {\" \"}\n                                  {division.name}{\" \"}\n                                </td>\n                                <td\n                                  width=\"25%\"\n                                  className=\"division-table-check\"\n                                >\n                                  <div className=\"customCheckbox\">\n                                    <input\n                                      type=\"checkbox\"\n                                      id={\"read_\" + division.id}\n                                      checked={divRead}\n                                      defaultValue=\"RESOURCE_READ\"\n                                      onChange={e => {\n                                        this.onGrantChange(e, division.id);\n                                      }}\n                                    />\n                                    <label\n                                      htmlFor={\"read_\" + division.id}\n                                    ></label>\n                                  </div>\n                                </td>\n                                <td\n                                  width=\"25%\"\n                                  className=\"division-table-check\"\n                                >\n                                  <div className=\"customCheckbox\">\n                                    <input\n                                      type=\"checkbox\"\n                                      defaultValue=\"RESOURCE_ANY\"\n                                      id={\"write_\" + division.id}\n                                      checked={divWrite}\n                                      onChange={e => {\n                                        this.onGrantChange(e, division.id);\n                                      }}\n                                    />\n                                    <label\n                                      htmlFor={\"write_\" + division.id}\n                                    ></label>\n                                  </div>\n                                </td>\n                              </tr>\n                              <tr>\n                                <th width=\"50%\">Team</th>\n                                <td width=\"25%\">\n                                  <div className=\"customCheckbox\">\n                                    <input type=\"checkbox\" id=\"check1\" />\n                                    <label htmlFor=\"check1\"></label>\n                                  </div>\n                                </td>\n                                <td width=\"25%\">\n                                  <div className=\"customCheckbox\">\n                                    <input type=\"checkbox\" id=\"check1\" />\n                                    <label htmlFor=\"check1\"></label>\n                                  </div>\n                                </td>\n                              </tr>\n                              <tr className=\"developer-td\">\n                                <th\n                                  width=\"50%\"\n                                  className=\"text-grey text-left division-table-name\"\n                                >\n                                  Developer\n                                </th>\n                                <td\n                                  width=\"25%\"\n                                  className=\"text-grey text-left division-table-name\"\n                                >\n                                  <div className=\"customCheckbox\">\n                                    <input type=\"checkbox\" id=\"check1\" />\n                                    <label htmlFor=\"check1\"></label>\n                                  </div>\n                                </td>\n                                <td\n                                  width=\"25%\"\n                                  className=\"text-grey text-left division-table-name\"\n                                >\n                                  <div className=\"customCheckbox\">\n                                    <input type=\"checkbox\" id=\"check1\" />\n                                    <label htmlFor=\"check1\"></label>\n                                  </div>\n                                </td>\n                              </tr>\n                            </div>\n                          );\n                        })}\n                    </tbody>\n                  </Table>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    domain: state.model.domain,\n    type: state.model.type\n  };\n}\n\nexport default connect(mapStateToProps)(ModalAcess);\n"]},"metadata":{},"sourceType":"module"}