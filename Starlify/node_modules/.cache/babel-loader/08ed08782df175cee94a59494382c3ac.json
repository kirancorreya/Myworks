{"ast":null,"code":"import _objectSpread from \"/Users/kirancorreya/Site/Starlify/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/kirancorreya/Site/Starlify/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/kirancorreya/Site/Starlify/src/components/pages/Main/Graph.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport * as d3 from \"d3\";\nimport * as PIXI from 'pixi.js-legacy';\nimport { Viewport } from 'pixi-viewport';\nimport { ForceGraph2D } from \"react-force-graph\";\nexport default function Graph(props) {\n  const _props$search = props.search,\n        filterText = _props$search === void 0 ? '' : _props$search,\n        _props$graph = props.graph,\n        graph = _props$graph === void 0 ? {\n    nodes: [],\n    links: []\n  } : _props$graph,\n        activeNodeId = props.activeNodeId,\n        hoverNodeId = props.hoverNodeId,\n        _props$toggleActiveNo = props.toggleActiveNodeId,\n        toggleActiveNodeId = _props$toggleActiveNo === void 0 ? () => {} : _props$toggleActiveNo,\n        _props$resize = props.resize,\n        forceResize = _props$resize === void 0 ? 0 : _props$resize,\n        _props$setHoverNodeId = props.setHoverNodeId,\n        setHoverNodeId = _props$setHoverNodeId === void 0 ? () => {} : _props$setHoverNodeId,\n        resizeTo = props.resizeTo;\n\n  let _useState = useState('tv'),\n      _useState2 = _slicedToArray(_useState, 2),\n      type = _useState2[0],\n      setType = _useState2[1];\n\n  let $view = useRef();\n  let PixieApp = useRef();\n  let viewport = useRef();\n  let simulation = useRef();\n  const textStyle = {\n    fontFamily: 'Arial',\n    fontSize: 24,\n    fill: 0xff1010,\n    anchor: 'middle'\n  };\n  let pixieContainer = new PIXI.Container();\n  let links = new PIXI.Graphics();\n  let nodes = new PIXI.Graphics();\n\n  function resetField() {\n    nodes.children = [];\n    links.children = [];\n    pixieContainer.children = [];\n    PixieApp.current.stage.children = [];\n  }\n\n  function resetView() {\n    if (!viewport.current) {\n      return;\n    }\n\n    viewport.current.scale._x = 1;\n    viewport.current.scale._y = 1;\n    viewport.current.snap(viewport.current.worldWidth, viewport.current.worldHeight, {\n      time: 300,\n      removeOnComplete: true\n    });\n  }\n\n  function resize() {\n    // Get the p\n    if (!PixieApp.current) {\n      return;\n    }\n\n    const parent = PixieApp.current.view.parentNode;\n\n    if (!parent) {\n      return;\n    } // Resize the renderer\n\n\n    console.log('width: %d, height: %d', parent.clientWidth, parent.clientHeight);\n    PixieApp.current.renderer.resize(parent.clientWidth, parent.clientHeight);\n    simulation.current.force('center', d3.forceCenter(parent.clientWidth / 2, parent.clientHeight / 2));\n\n    if (!viewport.current) {\n      return;\n    }\n\n    viewport.current.fitWidth(parent.clientWidth);\n    viewport.current.fitHeight(parent.clientHeight);\n  }\n\n  function createTriangle(size = 10, color = 0xFF0000, inverse = false) {\n    let triangle = new PIXI.Graphics();\n    let halfSize = size / 2;\n    triangle.beginFill(color, 1);\n    triangle.lineStyle(0, color, 1);\n    triangle.moveTo(0, halfSize);\n    triangle.lineTo(size, 0); //triangle.lineTo(size, size);\n\n    if (inverse) {\n      triangle.bezierCurveTo(size, 0, 0.7 * size, 0.5 * size, size, size);\n    } else {\n      triangle.bezierCurveTo(size, 0, 1.3 * size, 0.5 * size, size, size);\n    }\n\n    triangle.lineTo(0, halfSize);\n    triangle.pivot.x = halfSize;\n    triangle.pivot.y = halfSize;\n    triangle.size = size; //triangle.rotation = Math.PI / 2;\n\n    triangle.endFill();\n    return triangle;\n  }\n\n  function dragstarted() {\n    if (type === 'circle') {\n      return;\n    }\n\n    if (!d3.event.active) simulation.current.alphaTarget(0.3).restart();\n    d3.event.subject.fx = d3.event.subject.x;\n    d3.event.subject.fy = d3.event.subject.y;\n  }\n\n  function dragged() {\n    d3.event.subject.fx = d3.event.x;\n    d3.event.subject.fy = d3.event.y;\n  }\n\n  function dragended() {\n    if (!d3.event.active) simulation.current.alphaTarget(0);\n    d3.event.subject.fx = null;\n    d3.event.subject.fy = null;\n  }\n\n  useEffect(() => {\n    let keyA = e => {\n      if (e.code !== 'KeyA') {\n        return;\n      }\n\n      resetView();\n    };\n\n    document.addEventListener('keyup', keyA);\n    return () => document.removeEventListener('keyup', keyA);\n  }, []);\n  useEffect(() => {\n    // create viewport\n    PixieApp.current = new PIXI.Application({\n      antialias: false,\n      autoDensity: true,\n      transparent: true\n    });\n    simulation.current = d3.forceSimulation().force('link', d3.forceLink().id(d => d.modeledEntityId).distance(200)).force('charge', d3.forceManyBody());\n    PixieApp.current.resizeTo = resizeTo.current; //PIXI.INTERACTION_FREQUENCY = 60;\n\n    $view.current.appendChild(PixieApp.current.view);\n    resize();\n  }, []);\n  useEffect(() => {\n    resetField();\n    simulation.current.nodes(graph.nodes).force('link').links(graph.links);\n    graph.nodes.forEach(node => {\n      let gfx = new PIXI.Container();\n      let circle = new PIXI.Graphics();\n      let text = new PIXI.Text(node.name, _objectSpread({}, textStyle, {\n        fontSize: 12\n      }));\n      let size = 25;\n      node.gfx = gfx;\n      gfx.circle = circle;\n      gfx.text = text;\n      gfx.circle.zIndex = 10;\n      gfx.circle.size = size;\n      circle.lineStyle(1.5, 0xFFFFFF);\n      circle.beginFill(0x000000);\n      circle.drawCircle(0, 0, size);\n      text.anchor.set(0.5, 0.5);\n      text.y = size + 10; // add node to Pixie Container\n\n      gfx.addChild(circle);\n      gfx.addChild(text);\n      nodes.addChild(gfx);\n    });\n    graph.links.forEach(link => {\n      let gfx = new PIXI.Container();\n      let startArrow = createTriangle(15, 0x0000ff, true); // blue\n\n      let endArrow = createTriangle(15); // red\n\n      let linkText = new PIXI.Text(link.type, {\n        fontSize: 12,\n        fill: 0xff1010\n      });\n      linkText.anchor.set(0.5, 1.5);\n      link.gfx = gfx;\n      gfx.startArrow = startArrow;\n      gfx.endArrow = endArrow;\n      gfx.text = linkText;\n      gfx.addChild(startArrow);\n      gfx.addChild(endArrow);\n      gfx.addChild(linkText);\n      links.addChild(gfx);\n    });\n    viewport.current = new Viewport({\n      stopPropagation: true,\n      interaction: PixieApp.current.renderer.plugins.interaction // the interaction module is important for wheel to work properly when renderer.view is placed or scaled\n\n    });\n    viewport.current.moveCorner(0, 0);\n    viewport.current.on('moved', x => {\n      console.log('worldScreenWidth', x.viewport.worldScreenWidth);\n      console.log('worldScreenHeight', x.viewport.worldScreenHeight);\n      console.log('center', x.viewport.center);\n    });\n    PixieApp.current.stage.addChild(viewport.current);\n    viewport.current.drag({\n      mouseButtons: 'right'\n    }).wheel();\n    viewport.current.addChild(pixieContainer);\n    pixieContainer.addChild(nodes);\n    pixieContainer.addChild(links);\n    /*        PixieApp.current.stage.addChild(viewport.current);\r\n            PixieApp.current.render(pixieContainer);*/\n\n    d3.select($view.current).call(d3.drag().container($view.current).subject(() => simulation.current.find(d3.event.x, d3.event.y)).on('start', dragstarted).on('drag', dragged).on('end', dragended));\n    simulation.current.on('tick', () => {\n      links.clear();\n      graph.nodes.forEach(node => {\n        let x = node.x,\n            y = node.y,\n            gfx = node.gfx;\n        gfx.position = new PIXI.Point(x, y);\n      });\n      graph.links.forEach(link => {\n        let source = link.source,\n            target = link.target,\n            gfx = link.gfx;\n        links.lineStyle(2, 0x000);\n        links.moveTo(source.x, source.y);\n        links.lineTo(target.x, target.y);\n        let angle = Math.atan2(source.y - target.y, source.x - target.x);\n        let textPosX = target.x - (target.x - source.x) / 2;\n        let textPosY = target.y - (target.y - source.y) / 2;\n        gfx.text.position.set(textPosX, textPosY);\n        gfx.text.rotation = angle;\n        /*                    gfx.startArrow.position.set(source.x, source.y);\r\n                            gfx.startArrow.rotation = angle;*/\n\n        gfx.startArrow.setTransform(source.x, source.y, 1, 1, angle, 0, 0, source.gfx.circle.size + gfx.startArrow.size - 3, gfx.startArrow.size / 2); // start arrow\n\n        gfx.endArrow.setTransform(target.x, target.y, 1, 1, angle, 0, 0, -1 * (source.gfx.circle.size / 2) + gfx.startArrow.size / 2 - 2, gfx.startArrow.size / 2); // end arrow\n        // right side\n\n        if (angle > -1 * (Math.PI / 2) && angle < Math.PI / 2) {\n          gfx.text.rotation = angle;\n        } else {\n          gfx.text.rotation = angle + Math.PI;\n        }\n      });\n      links.endFill();\n    });\n  }, [graph]);\n  useEffect(() => {\n    resize();\n    window.addEventListener('resize', resize);\n    return () => window.removeEventListener('resize', resize);\n  }, [forceResize]);\n  useEffect(() => {\n    const keyPressT = e => {\n      if (e.code !== 'KeyT') {\n        return;\n      }\n\n      if (Array.from(document.querySelectorAll(':focus')).length > 0) {\n        return;\n      }\n\n      let newType = type === 'circle' ? 'tv' : 'circle';\n      setType(newType);\n    };\n\n    document.addEventListener('keydown', keyPressT);\n    return () => document.removeEventListener('keydown', keyPressT);\n  }, [type]);\n  return React.createElement(\"div\", {\n    ref: $view,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282\n    },\n    __self: this\n  });\n}","map":{"version":3,"sources":["/Users/kirancorreya/Site/Starlify/src/components/pages/Main/Graph.js"],"names":["React","useState","useEffect","useRef","d3","PIXI","Viewport","ForceGraph2D","Graph","props","search","filterText","graph","nodes","links","activeNodeId","hoverNodeId","toggleActiveNodeId","resize","forceResize","setHoverNodeId","resizeTo","type","setType","$view","PixieApp","viewport","simulation","textStyle","fontFamily","fontSize","fill","anchor","pixieContainer","Container","Graphics","resetField","children","current","stage","resetView","scale","_x","_y","snap","worldWidth","worldHeight","time","removeOnComplete","parent","view","parentNode","console","log","clientWidth","clientHeight","renderer","force","forceCenter","fitWidth","fitHeight","createTriangle","size","color","inverse","triangle","halfSize","beginFill","lineStyle","moveTo","lineTo","bezierCurveTo","pivot","x","y","endFill","dragstarted","event","active","alphaTarget","restart","subject","fx","fy","dragged","dragended","keyA","e","code","document","addEventListener","removeEventListener","Application","antialias","autoDensity","transparent","forceSimulation","forceLink","id","d","modeledEntityId","distance","forceManyBody","appendChild","forEach","node","gfx","circle","text","Text","name","zIndex","drawCircle","set","addChild","link","startArrow","endArrow","linkText","stopPropagation","interaction","plugins","moveCorner","on","worldScreenWidth","worldScreenHeight","center","drag","mouseButtons","wheel","select","call","container","find","clear","position","Point","source","target","angle","Math","atan2","textPosX","textPosY","rotation","setTransform","PI","window","keyPressT","Array","from","querySelectorAll","length","newType"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef} from \"react\";\r\nimport * as d3 from \"d3\";\r\nimport * as PIXI from 'pixi.js-legacy';\r\nimport {Viewport} from 'pixi-viewport';\r\nimport {ForceGraph2D} from \"react-force-graph\";\r\n\r\nexport default function Graph(props) {\r\n    const {search: filterText = '',\r\n        graph = {nodes: [], links: []},\r\n        activeNodeId,\r\n        hoverNodeId,\r\n        toggleActiveNodeId = () => {},\r\n        resize: forceResize = 0,\r\n        setHoverNodeId = () => {}, resizeTo} = props;\r\n\r\n\r\n    let [type, setType] = useState('tv');\r\n    let $view = useRef();\r\n\r\n    let PixieApp = useRef();\r\n    let viewport = useRef();\r\n    let simulation = useRef();\r\n\r\n    const textStyle = {fontFamily : 'Arial', fontSize: 24, fill: 0xff1010, anchor: 'middle'};\r\n    let pixieContainer = new PIXI.Container();\r\n    let links = new PIXI.Graphics();\r\n    let nodes = new PIXI.Graphics();\r\n\r\n    function resetField() {\r\n        nodes.children = [];\r\n        links.children = [];\r\n        pixieContainer.children = [];\r\n        PixieApp.current.stage.children = [];\r\n    }\r\n    function resetView() {\r\n        if (!viewport.current) {\r\n            return;\r\n        }\r\n        viewport.current.scale._x = 1;\r\n        viewport.current.scale._y = 1;\r\n\r\n        viewport.current.snap(viewport.current.worldWidth, viewport.current.worldHeight, {\r\n            time: 300,\r\n            removeOnComplete: true\r\n        });\r\n    }\r\n    function resize() {\r\n        // Get the p\r\n        if (!PixieApp.current) {\r\n            return;\r\n        }\r\n        const parent = PixieApp.current.view.parentNode;\r\n        if (!parent) {\r\n            return;\r\n        }\r\n        // Resize the renderer\r\n        console.log('width: %d, height: %d', parent.clientWidth, parent.clientHeight);\r\n        PixieApp.current.renderer.resize(parent.clientWidth, parent.clientHeight);\r\n        simulation.current.force('center', d3.forceCenter(parent.clientWidth / 2, parent.clientHeight / 2));\r\n\r\n        if (!viewport.current) {\r\n            return;\r\n        }\r\n\r\n        viewport.current.fitWidth(parent.clientWidth);\r\n        viewport.current.fitHeight(parent.clientHeight);\r\n    }\r\n    function createTriangle(size = 10, color = 0xFF0000, inverse = false) {\r\n        let triangle = new PIXI.Graphics();\r\n\r\n        let halfSize = size / 2;\r\n\r\n        triangle.beginFill(color, 1);\r\n        triangle.lineStyle(0, color, 1);\r\n        triangle.moveTo(0, halfSize);\r\n        triangle.lineTo(size, 0);\r\n        //triangle.lineTo(size, size);\r\n        if (inverse) {\r\n            triangle.bezierCurveTo(size, 0, 0.7 * size, 0.5 * size, size, size);\r\n        } else {\r\n            triangle.bezierCurveTo(size, 0, 1.3 * size, 0.5 * size, size, size);\r\n        }\r\n        triangle.lineTo(0, halfSize);\r\n        triangle.pivot.x = halfSize;\r\n        triangle.pivot.y = halfSize;\r\n\r\n        triangle.size = size;\r\n        //triangle.rotation = Math.PI / 2;\r\n        triangle.endFill();\r\n\r\n        return triangle;\r\n    }\r\n    function dragstarted() {\r\n        if (type === 'circle') {\r\n            return;\r\n        }\r\n        if (!d3.event.active) simulation.current.alphaTarget(0.3).restart();\r\n        d3.event.subject.fx = d3.event.subject.x;\r\n        d3.event.subject.fy = d3.event.subject.y;\r\n    }\r\n    function dragged() {\r\n        d3.event.subject.fx = d3.event.x;\r\n        d3.event.subject.fy = d3.event.y;\r\n    }\r\n    function dragended() {\r\n        if (!d3.event.active) simulation.current.alphaTarget(0);\r\n        d3.event.subject.fx = null;\r\n        d3.event.subject.fy = null;\r\n    }\r\n    useEffect(() => {\r\n        let keyA = e => {\r\n            if (e.code !== 'KeyA') {\r\n                return;\r\n            }\r\n            resetView();\r\n        };\r\n        document.addEventListener('keyup', keyA);\r\n        return () => document.removeEventListener('keyup', keyA);\r\n    }, []);\r\n    useEffect(() => {\r\n        // create viewport\r\n        PixieApp.current = new PIXI.Application({\r\n            antialias: false,\r\n            autoDensity: true,\r\n            transparent: true\r\n        });\r\n\r\n        simulation.current = d3.forceSimulation()\r\n            .force('link', d3.forceLink().id(d => d.modeledEntityId).distance(200))\r\n            .force('charge', d3.forceManyBody());\r\n\r\n        PixieApp.current.resizeTo = resizeTo.current;\r\n        //PIXI.INTERACTION_FREQUENCY = 60;\r\n\r\n        $view.current.appendChild(PixieApp.current.view);\r\n\r\n        resize();\r\n    }, []);\r\n    useEffect(() => {\r\n        resetField();\r\n        simulation.current\r\n            .nodes(graph.nodes)\r\n            .force('link').links(graph.links);\r\n\r\n        graph.nodes.forEach(node => {\r\n            let gfx = new PIXI.Container();\r\n            let circle = new PIXI.Graphics();\r\n            let text = new PIXI.Text(node.name, {\r\n                ...textStyle,\r\n                fontSize: 12\r\n            });\r\n            let size = 25;\r\n\r\n            node.gfx = gfx;\r\n            gfx.circle = circle;\r\n            gfx.text = text;\r\n\r\n            gfx.circle.zIndex = 10;\r\n            gfx.circle.size = size;\r\n\r\n            circle.lineStyle(1.5, 0xFFFFFF);\r\n            circle.beginFill(0x000000);\r\n            circle.drawCircle(0, 0, size);\r\n\r\n            text.anchor.set(0.5, 0.5);\r\n            text.y = size + 10;\r\n\r\n            // add node to Pixie Container\r\n            gfx.addChild(circle);\r\n            gfx.addChild(text);\r\n\r\n            nodes.addChild(gfx);\r\n        });\r\n        graph.links.forEach(link => {\r\n            let gfx = new PIXI.Container();\r\n            let startArrow = createTriangle(15, 0x0000ff, true); // blue\r\n            let endArrow = createTriangle(15); // red\r\n            let linkText = new PIXI.Text(link.type, {\r\n                fontSize: 12,\r\n                fill: 0xff1010\r\n            });\r\n\r\n            linkText.anchor.set(0.5, 1.5);\r\n\r\n            link.gfx = gfx;\r\n            gfx.startArrow = startArrow;\r\n            gfx.endArrow = endArrow;\r\n            gfx.text = linkText;\r\n\r\n            gfx.addChild(startArrow);\r\n            gfx.addChild(endArrow);\r\n            gfx.addChild(linkText);\r\n            links.addChild(gfx);\r\n        });\r\n\r\n        viewport.current = new Viewport({\r\n            stopPropagation: true,\r\n            interaction: PixieApp.current.renderer.plugins.interaction // the interaction module is important for wheel to work properly when renderer.view is placed or scaled\r\n        });\r\n        viewport.current.moveCorner(0, 0);\r\n        viewport.current.on('moved', (x) => {\r\n            console.log('worldScreenWidth', x.viewport.worldScreenWidth);\r\n            console.log('worldScreenHeight', x.viewport.worldScreenHeight);\r\n            console.log('center', x.viewport.center);\r\n        });\r\n        PixieApp.current.stage.addChild(viewport.current);\r\n        viewport.current\r\n            .drag({ mouseButtons: 'right' })\r\n            .wheel();\r\n        viewport.current.addChild(pixieContainer);\r\n\r\n        pixieContainer.addChild(nodes);\r\n        pixieContainer.addChild(links);\r\n\r\n/*        PixieApp.current.stage.addChild(viewport.current);\r\n        PixieApp.current.render(pixieContainer);*/\r\n\r\n        d3.select($view.current)\r\n            .call(d3.drag()\r\n                .container($view.current)\r\n                .subject(() => simulation.current.find(d3.event.x, d3.event.y))\r\n                .on('start', dragstarted)\r\n                .on('drag', dragged)\r\n                .on('end', dragended));\r\n\r\n\r\n        simulation.current.on('tick', () => {\r\n            links.clear();\r\n            graph.nodes.forEach(node => {\r\n                let { x, y, gfx } = node;\r\n                gfx.position = new PIXI.Point(x, y);\r\n            });\r\n            graph.links.forEach(link => {\r\n                let { source, target, gfx } = link;\r\n                links.lineStyle(2, 0x000);\r\n                links.moveTo(source.x, source.y);\r\n                links.lineTo(target.x, target.y);\r\n\r\n\r\n                let angle = Math.atan2(source.y - target.y, source.x - target.x);\r\n                let textPosX = target.x - ((target.x - source.x) / 2);\r\n                let textPosY = target.y - ((target.y - source.y) / 2);\r\n                gfx.text.position.set(textPosX, textPosY);\r\n                gfx.text.rotation = angle;\r\n\r\n\r\n                /*                    gfx.startArrow.position.set(source.x, source.y);\r\n                                    gfx.startArrow.rotation = angle;*/\r\n\r\n                gfx.startArrow.setTransform(source.x, source.y, 1, 1, angle, 0, 0, source.gfx.circle.size + gfx.startArrow.size - 3, gfx.startArrow.size / 2); // start arrow\r\n                gfx.endArrow.setTransform(target.x, target.y, 1, 1, angle, 0, 0, -1 * (source.gfx.circle.size / 2) + (gfx.startArrow.size / 2) - 2, gfx.startArrow.size / 2); // end arrow\r\n                // right side\r\n                if (angle > -1 *(Math.PI / 2) && angle < ( Math.PI / 2)) {\r\n                    gfx.text.rotation = angle;\r\n                } else {\r\n                    gfx.text.rotation = angle + Math.PI;\r\n                }\r\n            });\r\n            links.endFill();\r\n        });\r\n    }, [graph]);\r\n    useEffect(() => {\r\n        resize();\r\n        window.addEventListener('resize', resize);\r\n        return () => window.removeEventListener('resize', resize);\r\n    }, [forceResize]);\r\n    useEffect(() => {\r\n        const keyPressT = e => {\r\n            if (e.code !== 'KeyT') {\r\n                return;\r\n            }\r\n            if (Array.from(document.querySelectorAll(':focus')).length > 0) {\r\n                return;\r\n            }\r\n            let newType = (type === 'circle') ? 'tv' : 'circle';\r\n            setType(newType);\r\n        };\r\n        document.addEventListener('keydown', keyPressT);\r\n        return () => document.removeEventListener('keydown', keyPressT);\r\n    }, [type]);\r\n\r\n    return <div ref={$view} />\r\n}"]},"metadata":{},"sourceType":"module"}