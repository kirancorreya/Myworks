{"ast":null,"code":"import _objectSpread from \"/Users/kirancorreya/Site/Starlify/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/kirancorreya/Site/Starlify/src/pages/dashboard/browsers/FlowDetails.js\";\nimport React, { Component } from \"react\";\nimport { fetchFlowDetils } from \"../../../store/system/systemActions\";\nimport { connect } from \"react-redux\";\nimport { Modal, ModalBody, FormGroup, Input } from \"reactstrap\";\nimport Select from 'react-select';\nimport check from \"../../../_assets/icons/icons/check-icon.svg\";\n\nclass FlowDetails extends Component {\n  constructor(props) {\n    super(props);\n\n    this.toggle = target => {\n      this.setState(_objectSpread({}, this.state, {\n        [target]: !this.state[target]\n      }));\n    };\n\n    this.state = {\n      details: {},\n      formData: {\n        name: \"\",\n        description: \"\",\n        supportLevel: \"\",\n        custom: {\n          \"documentationUrl\": ''\n        }\n      },\n      filterOptions: []\n    };\n    this.close = this.close.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.toggleDescription = this.toggleDescription.bind(this);\n    this.modalToggle = this.modalToggle.bind(this);\n  } //show or hide tool tip\n\n\n  handleUrlChange(event) {\n    const formData = this.state.formData;\n    formData[event.target.name] = {\n      \"documentationUrl\": event.target.value\n    };\n    this.setState({\n      formData\n    });\n  }\n\n  handleChange(event) {\n    const formData = this.state.formData;\n    formData[event.target.name] = event.target.value;\n    this.setState({\n      formData\n    });\n  }\n\n  updateFlow() {\n    fetch(process.env.REACT_APP_API + \"\".concat(this.props.activeModel, \"/flow/\") + this.props.activeFlow, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(this.state.formData)\n    }).then(response => {\n      if (this.state.deletedSourceSystems.length > 0) this.deleteSourceSystems();\n      if (this.state.deletedTargetSystems.length > 0) this.deleteTargetSystems();\n      this.addSourceSystems();\n      this.addTargetSystems();\n      setTimeout(() => {\n        this.props.getFlowDetails(this.props.activeModelId, this.props.activeFlow);\n        this.setState(prevState => ({\n          modal: !prevState.modal\n        }));\n      }, 2000);\n    }).catch(error => console.log(error));\n  }\n\n  addSourceSystems() {\n    console.log(this.state.sourceSystems);\n    this.state.sourceSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/source/' + system.value, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => {}).catch(error => console.log(error));\n      return true;\n    });\n  }\n\n  addTargetSystems() {\n    this.state.targetSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/target/' + system.value, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => {}).catch(error => console.log(error));\n      return true;\n    });\n  }\n\n  deleteSourceSystems() {\n    this.state.deletedSourceSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/source/' + system.value, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => {}).catch(error => console.log(error));\n      return true;\n    });\n  }\n\n  deleteTargetSystems() {\n    console.log(this.state.deletedTargetSystems);\n    this.state.deletedTargetSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/target/' + system.value, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(response => {}).catch(error => console.log(error));\n      return true;\n    });\n  }\n\n  handleSourceChange(option, event) {\n    console.log(option);\n    let difference = this.state.sourceSystems.filter(x => !option.includes(x)); // calculates diff\n\n    console.log(difference);\n\n    if (difference.length > 0) {\n      this.state.deletedSourceSystems.push(difference[0]);\n    }\n\n    this.setState(state => {\n      return {\n        sourceSystems: option\n      };\n    });\n  }\n\n  handleTargetChange(option) {\n    let difference = this.state.targetSystems.filter(x => !option.includes(x)); // calculates diff\n\n    if (difference.length > 0) {\n      this.state.deletedTargetSystems.push(difference[0]);\n    }\n\n    this.setState(state => {\n      return {\n        targetSystems: option\n      };\n    });\n  } //show or hide description\n\n\n  toggleDescription() {\n    this.setState(state => ({\n      collapse: !state.collapse\n    }));\n  } //closes the detail window\n\n\n  close(type) {\n    this.props.close(type);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.activeFlow !== nextProps.activeFlow) this.props.getFlowDetails(this.props.activeModelId, nextProps.activeFlow);\n  } //get flow details\n\n\n  componentWillMount() {\n    this.props.getFlowDetails(this.props.activeModelId, this.props.activeFlow);\n  } //update flow details\n\n\n  updateFlowDetails(event) {\n    let value = event.target.value;\n\n    if ((event.key === \"Enter\" || event.type === \"blur\") && this.state.modal && value) {\n      event.target.value = \"\";\n      this.setState(prevState => ({\n        modal: !prevState.modal\n      }));\n      fetch(process.env.REACT_APP_API + \"\".concat(this.props.activeModel, \"/flow/\") + this.props.activeFlow, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          description: value\n        })\n      }).then(response => {\n        this.props.getFlowDetails(this.props.activeModel, this.props.activeFlow);\n      }).catch(error => console.log(error));\n    }\n  } //control right click modal\n\n\n  modalToggle(e, data) {\n    this.state.sourceSystems = [];\n    this.state.targetSystems = [];\n    this.state.deletedSourceSystems = [];\n    this.state.deletedTargetSystems = [];\n    this.setState(prevState => ({\n      modal: !prevState.modal\n    }));\n\n    this.props.flowDetails._links.filter(links => links.rel === 'SOURCE').map(source => {\n      this.state.sourceSystems.push({\n        'value': source.params.id,\n        'label': source.title\n      });\n    });\n\n    this.props.flowDetails._links.filter(links => links.rel === 'TARGET').map(target => {\n      this.state.targetSystems.push({\n        'value': target.params.id,\n        'label': target.title\n      });\n    });\n\n    this.setState({\n      formData: {\n        name: this.props.flowDetails.name,\n        description: this.props.flowDetails.description,\n        supportLevel: this.props.flowDetails.supportLevel,\n        custom: {\n          \"documentationUrl\": this.props.flowDetails.custom.documentationUrl\n        }\n      }\n    });\n    this.getSystems();\n  }\n\n  getSystems() {\n    return fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/allsystems').then(res => res.json()).then(response => {\n      this.setState({\n        'systems': response\n      });\n      response.map((systems, i) => {\n        this.state.filterOptions.push({\n          'value': systems.id,\n          'label': systems.name\n        });\n      });\n    }).catch(error => console.log(error));\n  }\n\n  render() {\n    var formData = this.state.formData;\n    return React.createElement(\"div\", {\n      className: \"browser\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      isOpen: this.state.modal,\n      toggle: this.modalToggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, React.createElement(ModalBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"editFlow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: \"d-inline-block modal-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, \"Edit Flow Details\"), React.createElement(\"button\", {\n      className: \"btn grey-btn modal-top-btn\",\n      onClick: this.updateFlow.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, \"Done \", React.createElement(\"img\", {\n      src: check,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"ModalInput m-t-50\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, \"Flow name\"), React.createElement(\"input\", {\n      type: \"text\",\n      value: formData.name,\n      name: \"name\",\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"ModalInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, React.createElement(Input, {\n      className: \"select-css\",\n      type: \"select\",\n      name: \"supportLevel\",\n      value: formData.supportLevel,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, \"Support Level\"), React.createElement(\"option\", {\n      value: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"Gold\"), React.createElement(\"option\", {\n      value: \"2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, \"Platinum\"), React.createElement(\"option\", {\n      value: \"3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307\n      },\n      __self: this\n    }, \"Silver\"), \"))}\"))), React.createElement(\"div\", {\n      className: \"ModalInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"Documentation URL\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"custom\",\n      value: formData.custom.documentationUrl,\n      onChange: this.handleUrlChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"ModalInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }, \"Description\"), React.createElement(\"textarea\", {\n      type: \"text\",\n      name: \"description\",\n      value: formData.description,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"ModalInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, \"Source system\"), React.createElement(\"div\", {\n      className: \"searchbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      sm: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, React.createElement(Select, {\n      name: \"filters\",\n      placeholder: \"Filters\",\n      value: this.state.sourceSystems,\n      options: this.state.filterOptions,\n      onChange: this.handleSourceChange.bind(this),\n      multi: true,\n      clearable: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"ModalInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338\n      },\n      __self: this\n    }, \"Target system\"), React.createElement(\"div\", {\n      className: \"searchbar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      sm: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340\n      },\n      __self: this\n    }, React.createElement(Select, {\n      name: \"filters\",\n      placeholder: \"Filters\",\n      value: this.state.targetSystems,\n      options: this.state.filterOptions,\n      onChange: this.handleTargetChange.bind(this),\n      multi: true,\n      clearable: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }))))))), React.createElement(\"div\", {\n      className: \"browser_header text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-key submenu-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }), React.createElement(\"h3\", {\n      className: \"d-inline-block\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, \"Flow Details\"), React.createElement(\"i\", {\n      className: \"far fa-edit\",\n      onClick: () => this.modalToggle(this, this.props.flowDetails),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362\n      },\n      __self: this\n    }), React.createElement(\"i\", {\n      className: \"fas fa-times system-down-icon browser_close\",\n      onClick: () => this.close(\"flowDetail\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"browser_wrapper browser_body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 373\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"name m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375\n      },\n      __self: this\n    }, \"Name\"), React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376\n      },\n      __self: this\n    }, this.props.flowDetails.name)), React.createElement(\"div\", {\n      className: \"support m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 379\n      },\n      __self: this\n    }, \"Support level\"), this.props.flowDetails.supportLevel === 1 && React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381\n      },\n      __self: this\n    }, \"Gold\"), this.props.flowDetails.supportLevel === 2 && React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }, \"Platinum\"), this.props.flowDetails.supportLevel === 3 && React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, \"Silver\")), React.createElement(\"div\", {\n      className: \"url m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    }, \"Documentation URL\"), React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    }, this.props.flowDetails.custom ? this.props.flowDetails.custom.documentationUrl : '')), React.createElement(\"div\", {\n      className: \"desc m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 396\n      },\n      __self: this\n    }, \"Description\"), React.createElement(\"p\", {\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }, this.props.flowDetails.description)), React.createElement(\"div\", {\n      className: \"system m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400\n      },\n      __self: this\n    }, \"Source\"), this.props.flowDetails._links ? this.props.flowDetails._links.filter(links => links.rel === 'SOURCE').map(source => {\n      return React.createElement(\"p\", {\n        className: \"text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405\n        },\n        __self: this\n      }, source.title);\n    }) : \"\"), React.createElement(\"div\", {\n      className: \"target m-b-20\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"text-grey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411\n      },\n      __self: this\n    }, \"Target\"), this.props.flowDetails._links ? this.props.flowDetails._links.filter(links => links.rel === 'TARGET').map(target => {\n      return React.createElement(\"p\", {\n        className: \"text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 416\n        },\n        __self: this\n      }, target.title);\n    }) : \"\")));\n  }\n\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    getFlowDetails: (modelId, flowId) => {\n      dispatch(fetchFlowDetils(modelId, flowId));\n    }\n  };\n}\n\nfunction mapStateToProps(state) {\n  return {\n    activeSystem: state.model.activeSystem,\n    activeFlow: state.system.activeFlow,\n    activeModel: state.model.modelUri,\n    flowDetails: state.system.flowDetails,\n    activeModelId: state.model.modelId\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FlowDetails);","map":{"version":3,"sources":["/Users/kirancorreya/Site/Starlify/src/pages/dashboard/browsers/FlowDetails.js"],"names":["React","Component","fetchFlowDetils","connect","Modal","ModalBody","FormGroup","Input","Select","FlowDetails","constructor","props","toggle","target","setState","state","details","formData","name","description","supportLevel","custom","filterOptions","close","bind","toggleDescription","modalToggle","handleUrlChange","event","value","handleChange","updateFlow","fetch","process","env","REACT_APP_API","activeModel","activeFlow","method","headers","body","JSON","stringify","then","response","deletedSourceSystems","length","deleteSourceSystems","deletedTargetSystems","deleteTargetSystems","addSourceSystems","addTargetSystems","setTimeout","getFlowDetails","activeModelId","prevState","modal","catch","error","console","log","sourceSystems","map","system","i","targetSystems","handleSourceChange","option","difference","filter","x","includes","push","handleTargetChange","collapse","type","componentWillReceiveProps","nextProps","componentWillMount","updateFlowDetails","key","e","data","flowDetails","_links","links","rel","source","params","id","title","documentationUrl","getSystems","res","json","systems","render","check","mapDispatchToProps","dispatch","modelId","flowId","mapStateToProps","activeSystem","model","modelUri"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { fetchFlowDetils } from \"../../../store/system/systemActions\";\nimport { connect } from \"react-redux\";\nimport {\n  Modal,\n  ModalBody,\n  FormGroup,\n  Input,\n} from \"reactstrap\";\nimport Select from 'react-select';\nimport check from \"../../../_assets/icons/icons/check-icon.svg\";\n\nclass FlowDetails extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      details: {},\n      formData: {\n        name: \"\",\n        description: \"\",\n        supportLevel: \"\",\n        custom: { \"documentationUrl\": '' }\n      },\n      filterOptions: [],\n    };\n\n    this.close = this.close.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.toggleDescription = this.toggleDescription.bind(this);\n    this.modalToggle = this.modalToggle.bind(this);\n  }\n\n  //show or hide tool tip\n  toggle = target => {\n    this.setState({\n      ...this.state,\n      [target]: !this.state[target]\n    });\n  };\n\n\n  handleUrlChange(event) {\n    const { formData } = this.state;\n    formData[event.target.name] = { \"documentationUrl\": event.target.value }\n    this.setState({\n      formData\n    });\n  }\n\n  handleChange(event) {\n    const { formData } = this.state;\n    formData[event.target.name] = event.target.value;\n    this.setState({\n      formData\n    });\n  }\n\n  updateFlow() {\n    fetch(\n      process.env.REACT_APP_API + `${this.props.activeModel}/flow/` + this.props.activeFlow,\n      {method: \"PATCH\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(this.state.formData)}\n    )\n      .then(response => {\n        if (this.state.deletedSourceSystems.length > 0) \n          this.deleteSourceSystems()\n        if (this.state.deletedTargetSystems.length > 0)\n          this.deleteTargetSystems()\n        this.addSourceSystems()\n        this.addTargetSystems()\n        setTimeout(() => {\n          this.props.getFlowDetails(this.props.activeModelId, this.props.activeFlow);\n          this.setState(prevState => ({\n            modal: !prevState.modal\n          }));\n        }, 2000);\n\n      })\n      .catch(error => console.log(error));\n\n\n\n  }\n\n  addSourceSystems() {\n    console.log(this.state.sourceSystems)\n    this.state.sourceSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/source/' + system.value,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }\n      )\n        .then(response => {\n\n\n\n        })\n        .catch(error => console.log(error));\n      return true\n\n    })\n\n  }\n\n  addTargetSystems() {\n    this.state.targetSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/target/' + system.value,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }\n      )\n        .then(response => {\n\n        })\n        .catch(error => console.log(error));\n      return true\n    })\n  }\n\n  deleteSourceSystems() {\n    this.state.deletedSourceSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/source/' + system.value,\n        {\n          method: \"DELETE\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }\n      )\n        .then(response => {\n\n        })\n        .catch(error => console.log(error));\n      return true\n    })\n  }\n\n  deleteTargetSystems() {\n    console.log(this.state.deletedTargetSystems)\n    this.state.deletedTargetSystems.map((system, i) => {\n      fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/flow/' + this.props.activeFlow + '/target/' + system.value,\n        {\n          method: \"DELETE\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }\n      )\n        .then(response => {\n\n        })\n        .catch(error => console.log(error));\n      return true\n    })\n  }\n\n  handleSourceChange(option, event) {console.log(option)\n    let difference = this.state.sourceSystems.filter(x => !option.includes(x)); // calculates diff\n    console.log(difference)\n    if (difference.length > 0) {\n      this.state.deletedSourceSystems.push(difference[0])\n    }\n    this.setState(state => {\n      return {\n        sourceSystems: option\n      };\n    });\n  }\n\n  handleTargetChange(option) {\n    let difference = this.state.targetSystems.filter(x => !option.includes(x)); // calculates diff\n    if (difference.length > 0) {\n      this.state.deletedTargetSystems.push(difference[0])\n    }\n    this.setState(state => {\n      return {\n        targetSystems: option\n      };\n    });\n  }\n\n  //show or hide description\n  toggleDescription() {\n    this.setState(state => ({ collapse: !state.collapse }));\n  }\n\n  //closes the detail window\n  close(type) {\n    this.props.close(type);\n  }\n  componentWillReceiveProps(nextProps) {\n    if (this.props.activeFlow !== nextProps.activeFlow)\n      this.props.getFlowDetails(this.props.activeModelId, nextProps.activeFlow);\n  }\n\n  //get flow details\n  componentWillMount() {\n    this.props.getFlowDetails(this.props.activeModelId, this.props.activeFlow);\n  }\n\n  //update flow details\n  updateFlowDetails(event) {\n    let value = event.target.value;\n    if (\n      (event.key === \"Enter\" || event.type === \"blur\") &&\n      this.state.modal &&\n      value\n    ) {\n      event.target.value = \"\";\n      this.setState(prevState => ({\n        modal: !prevState.modal\n      }));\n      fetch(\n        process.env.REACT_APP_API +\n          `${this.props.activeModel}/flow/` +\n          this.props.activeFlow,\n        {\n          method: \"PATCH\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ description: value })\n        }\n      )\n        .then(response => {\n          this.props.getFlowDetails(\n            this.props.activeModel,\n            this.props.activeFlow\n          );\n        })\n        .catch(error => console.log(error));\n    }\n  }\n\n  //control right click modal\n  modalToggle(e, data) {\n    this.state.sourceSystems = []\n    this.state.targetSystems = []\n    this.state.deletedSourceSystems = []\n    this.state.deletedTargetSystems = []\n    this.setState(prevState => ({\n      modal: !prevState.modal\n    }));\n\n\n    this.props.flowDetails._links\n          .filter(links => links.rel=== 'SOURCE')\n          .map((source) => {\n         this.state.sourceSystems.push({ 'value': source.params.id, 'label': source.title })\n    }) \n\n   this.props.flowDetails._links\n          .filter(links => links.rel=== 'TARGET')\n          .map((target) => {\n         this.state.targetSystems.push({ 'value': target.params.id, 'label': target.title })\n    }) \n\n\n    this.setState({\n      formData: {\n        name: this.props.flowDetails.name,\n        description: this.props.flowDetails.description,\n        supportLevel: this.props.flowDetails.supportLevel,\n        custom: { \"documentationUrl\": this.props.flowDetails.custom.documentationUrl }\n      }\n    });\n    this.getSystems()\n\n  }\n\n  getSystems() {\n    return fetch(process.env.REACT_APP_API + '/hypermedia/network/' + this.props.activeModelId + '/allsystems')\n      .then(res => res.json())\n      .then(response => {\n        this.setState({ 'systems': response })\n        response.map((systems, i) => {\n          this.state.filterOptions.push({ 'value': systems.id, 'label': systems.name })\n        })\n      })\n      .catch(error => console.log(error));\n  }\n\n  render() {\n    var { formData } = this.state;\n    return (\n      <div className=\"browser\">\n        <Modal isOpen={this.state.modal} toggle={this.modalToggle}>\n          <ModalBody>\n            <div className=\"editFlow\">\n              <h3 className=\"d-inline-block modal-title\">Edit Flow Details</h3>\n              <button className=\"btn grey-btn modal-top-btn\" onClick={this.updateFlow.bind(this)}>\n                Done <img src={check} alt=\"\" />\n              </button>\n              <div className=\"ModalInput m-t-50\">\n                <h4>Flow name</h4>\n                <input type=\"text\" value={formData.name} name=\"name\" onChange={this.handleChange.bind(this)}/>\n              </div>\n              <div className=\"ModalInput\">\n                <FormGroup>\n                  <Input className=\"select-css\" type=\"select\" name=\"supportLevel\" value={formData.supportLevel} onChange={this.handleChange.bind(this)}>\n                    <option value=\"\">Support Level</option>\n                    <option value=\"1\">Gold</option>\n                    <option value=\"2\">Platinum</option>\n                    <option value=\"3\">Silver</option>\n                    ))}\n                  </Input>\n                </FormGroup>\n              </div>\n              <div className=\"ModalInput\">\n                <h4>Documentation URL</h4>\n                <input type=\"text\" name=\"custom\" value={formData.custom.documentationUrl} onChange={this.handleUrlChange.bind(this)}/>\n              </div>\n              <div className=\"ModalInput\">\n                <h4>Description</h4>\n                <textarea type=\"text\" name=\"description\" value={formData.description}\n                onChange={this.handleChange.bind(this)}/>\n              </div>\n              <div className=\"ModalInput\">\n                <h4>Source system</h4>\n                <div className=\"searchbar\">\n                  <div sm=\"12\">\n                  <Select\n              name=\"filters\"\n              placeholder=\"Filters\"\n              value={this.state.sourceSystems}\n              options={this.state.filterOptions}\n              onChange={this.handleSourceChange.bind(this)}\n              multi\n              clearable={false}\n            />\n                  </div>\n                </div>\n              </div>\n              <div className=\"ModalInput\">\n                <h4>Target system</h4>\n                <div className=\"searchbar\">\n                  <div sm=\"12\">\n                  <Select\n              name=\"filters\"\n              placeholder=\"Filters\"\n              value={this.state.targetSystems}\n              options={this.state.filterOptions}\n              onChange={this.handleTargetChange.bind(this)}\n              multi\n              clearable={false}\n            />\n                  </div>\n                </div>\n              </div>\n            </div>\n           \n          </ModalBody>\n        </Modal>\n       \n        <div className=\"browser_header text-white\">\n          <div>\n            <i className=\"fas fa-key submenu-icon\"></i>\n            <h3 className=\"d-inline-block\">Flow Details</h3>\n            <i\n              className=\"far fa-edit\"\n              onClick={() => this.modalToggle(this, this.props.flowDetails)}\n            ></i>\n            <i\n              className=\"fas fa-times system-down-icon browser_close\"\n              onClick={() => this.close(\"flowDetail\")}\n            />\n          </div>\n        </div>\n\n        <div className=\"browser_wrapper browser_body\">\n          <div className=\"name m-b-20\">\n            <p className=\"text-grey\">Name</p>\n            <p className=\"text-white\">{this.props.flowDetails.name}</p>\n          </div>\n          <div className=\"support m-b-20\">\n            <p className=\"text-grey\">Support level</p>\n            {this.props.flowDetails.supportLevel === 1 && (\n               <p className=\"text-white\">Gold</p>\n            )}\n            {this.props.flowDetails.supportLevel === 2 && (\n               <p className=\"text-white\">Platinum</p>\n            )}\n            {this.props.flowDetails.supportLevel === 3 && (\n               <p className=\"text-white\">Silver</p>\n            )}\n           \n          </div>\n          <div className=\"url m-b-20\">\n            <p className=\"text-grey\">Documentation URL</p>\n            <p className=\"text-white\">{this.props.flowDetails.custom ? this.props.flowDetails.custom.documentationUrl : ''}</p>\n          </div>\n          <div className=\"desc m-b-20\">\n            <p className=\"text-grey\">Description</p>\n            <p className=\"text-white\">{this.props.flowDetails.description}</p>\n          </div>\n          <div className=\"system m-b-20\">\n            <p className=\"text-grey\">Source</p>\n            {this.props.flowDetails._links\n              ? this.props.flowDetails._links\n                  .filter(links => links.rel=== 'SOURCE')\n                  .map((source) => {\n                      return <p className=\"text-white\">{source.title}</p>\n                    })\n                  : \"\"}\n            \n          </div>\n          <div className=\"target m-b-20\">\n            <p className=\"text-grey\">Target</p>\n            {this.props.flowDetails._links\n              ? this.props.flowDetails._links\n                  .filter(links => links.rel=== 'TARGET')\n                  .map((target) => {\n                      return <p className=\"text-white\">{target.title}</p>\n                    })\n                  : \"\"}\n          </div>\n\n          \n         \n        \n          \n         \n        </div>\n      </div>\n    );\n  }\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    getFlowDetails: (modelId, flowId) => {\n      dispatch(fetchFlowDetils(modelId, flowId));\n    }\n  };\n}\n\nfunction mapStateToProps(state) {\n  return {\n    activeSystem: state.model.activeSystem,\n    activeFlow: state.system.activeFlow,\n    activeModel: state.model.modelUri,\n    flowDetails: state.system.flowDetails,\n    activeModelId: state.model.modelId\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(FlowDetails);\n"]},"metadata":{},"sourceType":"module"}